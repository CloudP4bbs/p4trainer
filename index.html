<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="RifaACS">
    <title>RifaACS - Gerenciador de Rifas</title>
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180' viewBox='0 0 180 180'%3E%3Crect width='180' height='180' fill='%233B82F6' rx='40'/%3E%3Cpath fill='white' d='M45 60h90v15H45zm0 30h90v15H45zm0 30h90v15H45z'/%3E%3C/svg%3E">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://apis.google.com/js/api.js" async defer></script>
    <style>
        /* ... (Toda a sua seção <style> permanece a mesma) ... */
    </style>
</head>
<body>
    <script>
        // ==================================================================
        // CONFIGURAÇÃO GOOGLE - ATUALIZADO
        // ==================================================================
        const GOOGLE_CLIENT_ID = '469226201678-rf8qdoccbhv1j56dldtga4fnbrqtnvrh.apps.googleusercontent.com';
        const GOOGLE_API_KEY = 'AIzaSyBHgoFJVRAW-mg4kVJDoOY9-LhLBC4jKVo';
        const DRIVE_APP_FOLDER = 'RifaACS_Data';
        const DRIVE_FILE_NAME = 'rifaacs_backup.json';
        // ==================================================================

        let vendedor = '';
        let intervaloInicio = 101;
        let intervaloFim = 200;
        let numeros = [];
        let numeroSelecionado = null;
        let googleTokenClient;
        let googleAccessToken;
        let googleDriveFileId = null;

        const STORAGE_KEYS = {
            vendedor: 'rifaacs_vendedor',
            intervaloInicio: 'rifaacs_inicio',
            intervaloFim: 'rifaacs_fim',
            numeros: 'rifaacs_numeros',
            configurado: 'rifaacs_configurado'
        };
        
        // ... (As funções salvarDados, carregarDados, etc. permanecem as mesmas até a função resetarApp) ...

        // ===============================================
        // NOVA FUNÇÃO resetarApp
        // ===============================================

        async function resetarApp() {
            const confirmacaoInicial = confirm('Você tem certeza que deseja resetar o aplicativo?');
            if (!confirmacaoInicial) {
                return;
            }

            // Se estiver conectado ao Google, oferece a opção de deletar o backup da nuvem
            if (googleAccessToken && googleDriveFileId) {
                const deletarNuvem = confirm('RESET AVANÇADO:\n\nVocê também deseja apagar o backup salvo na sua conta Google Drive?\n\nOK = Apagar TUDO (local + nuvem)\nCancelar = Apagar apenas dados locais e desconectar');
                if (deletarNuvem) {
                    try {
                        await deletarArquivoDoDrive();
                        alert('Backup do Google Drive apagado com sucesso.');
                    } catch (error) {
                        alert('Não foi possível apagar o backup do Google Drive. Verifique sua conexão e tente novamente.');
                        console.error("Erro ao deletar arquivo do Drive: ", error);
                    }
                }
            }

            // Desconecta a conta Google do app para evitar recarregamento automático
            if (googleAccessToken) {
                google.accounts.oauth2.revoke(googleAccessToken, () => {
                    console.log('Token de acesso do Google revogado.');
                });
            }

            // Limpa os dados locais e recarrega a página para a tela inicial
            limparDados();
            alert('Aplicativo resetado. Você será direcionado para a tela inicial.');
            location.reload();
        }

        // ===============================================
        // NOVA FUNÇÃO AUXILIAR para deletar da nuvem
        // ===============================================

        async function deletarArquivoDoDrive() {
            if (!gapi.client.drive || !googleDriveFileId) {
                console.log("Não é possível deletar: API do Drive não carregada ou arquivo não encontrado.");
                return;
            }
            try {
                await gapi.client.drive.files.delete({
                    'fileId': googleDriveFileId
                });
                googleDriveFileId = null; // Limpa o ID do arquivo localmente
            } catch (error) {
                console.error('Erro ao tentar deletar o arquivo no Drive:', error);
                throw error; // Propaga o erro para ser tratado na função resetarApp
            }
        }
        
        // ... (O restante de todas as suas outras funções JavaScript permanecem exatamente iguais) ...
        
        // --- Exemplo de onde a função antiga estava ---
        /*
        function resetarApp_ANTIGA() {
            if (confirm('Tem certeza que deseja resetar todos os dados? Esta ação não pode ser desfeita.')) {
                limparDados();
                location.reload();
            }
        }
        */
        
        // --- O resto do seu código JS ---
        // (Copie todas as outras funções, como `inicializarApp`, `atualizarGrid`, etc., aqui)
    </script>
</body>
</html>
